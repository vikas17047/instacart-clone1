<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Store</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --p-color: #008060; }
        body { margin: 0; font-family: sans-serif; background: #f9f9f9; padding-bottom: 80px; }
        .announce { background: #000; color: white; text-align: center; padding: 8px; font-size: 0.75rem; font-weight: 700; }
        .hero { height: 200px; background: #333 center/cover; position: relative; display: flex; align-items: center; justify-content: center; color: white; }
        .p-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 15px; }
        .p-card { background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .p-img { width: 100%; height: 160px; object-fit: cover; }
        .add-btn { width: 100%; padding: 10px; border: none; background: var(--p-color); color: white; font-weight: 700; cursor: pointer; }
        /* Floating WhatsApp */
        .wa-float { position: fixed; bottom: 20px; right: 20px; background: #25D366; color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2rem; box-shadow: 0 4px 10px rgba(0,0,0,0.3); z-index: 1000; text-decoration: none; }
    </style>
</head>
<body>

    <div class="announce" id="annText">SHOP NOW - NEW ARRIVALS!</div>
    <div class="hero" id="bannerImg"><h1 id="sNameDisplay">MY STORE</h1></div>

    <div class="p-grid" id="productGrid"></div>

    <a href="#" id="waChat" class="wa-float" target="_blank">
        <i class="fab fa-whatsapp"></i>
    </a>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        // Load Customization
        const sName = localStorage.getItem('store_name') || "My Store";
        const themeCol = localStorage.getItem('store_color') || "#008060";
        document.getElementById('sNameDisplay').innerText = sName;
        document.getElementById('annText').style.background = themeCol;
        document.getElementById('waChat').style.background = themeCol; // Brand matching
        document.documentElement.style.setProperty('--p-color', themeCol);

        // WhatsApp Link
        const waNum = localStorage.getItem('store_whatsapp') || "919876543210";
        document.getElementById('waChat').href = `https://wa.me/${waNum}?text=Hi ${sName}, I am interested in your products.`;

        const firebaseConfig = {
            apiKey: "AIzaSyCqh5b-p5dsiU6AtkWRbyD0rSUD62Izqeg",
            authDomain: "instacart-clone-91062.firebaseapp.com",
            projectId: "instacart-clone-91062",
            storageBucket: "instacart-clone-91062.firebasestorage.app",
            messagingSenderId: "232217818928",
            appId: "1:232217818928:web:e05efedfda36263f6cfaf5"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function loadProds() {
            const grid = document.getElementById('productGrid');
            const snap = await getDocs(collection(db, "products"));
            grid.innerHTML = "";
            snap.forEach(doc => {
                const d = doc.data();
                grid.innerHTML += `<div class="p-card"><img src="${d.image}" class="p-img"><div style="padding:10px;"><div style="font-weight:700;">${d.name}</div><div style="color:var(--p-color); margin-top:5px;">â‚¹${d.price}</div></div><button class="add-btn">Add to Bag</button></div>`;
            });
        }
        loadProds();
    </script>
</body>
</html>
