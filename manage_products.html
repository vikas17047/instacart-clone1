<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Inventory</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background: #f2f5f8; padding-bottom: 90px; }
        .page-header { background: white; padding: 15px; border-bottom: 1px solid #eee; display: flex; align-items: center; gap: 10px; }
        .prod-item { background: white; padding: 15px; margin: 10px 15px; border-radius: 8px; display: flex; gap: 15px; align-items: center; border: 1px solid #eee; }
        .prod-img { width: 70px; height: 70px; object-fit: cover; border-radius: 5px; }
        .prod-info { flex: 1; }
        .fab-btn { position: fixed; bottom: 25px; right: 25px; background: black; color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; border: none; }
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 2000; align-items: flex-end; }
        .modal-content { background: white; width: 100%; padding: 25px; border-radius: 20px 20px 0 0; }
        .form-input { width: 100%; padding: 12px; border: 1px solid #ddd; margin-bottom: 15px; border-radius: 5px; box-sizing: border-box; }
        .save-btn { width: 100%; background: black; color: white; padding: 15px; border: none; font-weight: 700; border-radius: 5px; }
    </style>
</head>
<body>

    <div class="page-header">
        <i class="fas fa-arrow-left" onclick="window.history.back()"></i>
        <h2 style="font-size:1.1rem; margin:0;">INVENTORY</h2>
    </div>

    <div id="productList">
        </div>

    <button class="fab-btn" onclick="openModal()"><i class="fas fa-plus"></i></button>

    <div id="addModal" class="modal">
        <div class="modal-content">
            <h3 style="margin-bottom:15px;">ADD PRODUCT</h3>
            <input type="text" id="newTitle" class="form-input" placeholder="Name">
            <input type="number" id="newPrice" class="form-input" placeholder="Price (₹)">
            <input type="text" id="newImg" class="form-input" placeholder="Image URL">
            <button class="save-btn" onclick="saveToFirebase()">SAVE TO DATABASE</button>
            <button onclick="closeModal()" style="width:100%; background:none; border:none; margin-top:10px; color:red;">Cancel</button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCqh5b-p5dsiU6AtkWRbyD0rSUD62Izqeg",
            authDomain: "instacart-clone-91062.firebaseapp.com",
            projectId: "instacart-clone-91062",
            storageBucket: "instacart-clone-91062.firebasestorage.app",
            messagingSenderId: "232217818928",
            appId: "1:232217818928:web:e05efedfda36263f6cfaf5"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        window.openModal = () => document.getElementById('addModal').style.display = 'flex';
        window.closeModal = () => document.getElementById('addModal').style.display = 'none';

        window.saveToFirebase = async () => {
            const title = document.getElementById('newTitle').value;
            const price = document.getElementById('newPrice').value;
            const img = document.getElementById('newImg').value;
            if(!title || !price) return alert("Fill Name and Price");
            await addDoc(collection(db, "products"), { name: title, price: price, image: img || "https://via.placeholder.com/150" });
            location.reload();
        }

        async function loadProducts() {
            const list = document.getElementById('productList');
            const snap = await getDocs(collection(db, "products"));
            list.innerHTML = "";
            snap.forEach((product) => {
                const d = product.data();
                list.innerHTML += `<div class="prod-item">
                    <img src="${d.image}" class="prod-img">
                    <div class="prod-info"><div class="prod-title">${d.name}</div><div class="prod-price">₹${d.price}</div></div>
                    <i class="fas fa-trash" style="color:red;" onclick="deleteProd('${product.id}')"></i>
                </div>`;
            });
        }
        window.deleteProd = async (id) => { if(confirm("Delete?")) { await deleteDoc(doc(db, "products", id)); location.reload(); } }
        loadProducts();
    </script>
</body>
</html>
